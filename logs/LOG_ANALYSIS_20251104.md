# 📊 로그 분석 리포트 (2025-11-04)

## 📅 분석 기간
- **날짜**: 2025년 11월 4일 (월요일)
- **로그 파일**: `paper_trader_20251104.log`, `paper_trading.log`
- **참고**: 11/5 로그는 아직 생성되지 않음

---

## 🔍 **주요 발견사항**

### ✅ **정상 작동 부분**

1. **Paper Trading API 연결 성공**
   ```
   2025-11-04 14:41:19 - Paper Trading 계정 상태: ACTIVE
   2025-11-04 14:41:19 - Paper Trading 계정 자산: $100,000.00
   2025-11-04 14:41:19 - 현금: $100,000.00
   ```
   ✅ Alpaca Paper Trading API 정상 연결

2. **모델 로드 성공**
   ```
   2025-11-04 14:41:19 - 개선된 전략 모델 로드 완료
   ```
   ✅ XGBoost 모델 정상 로드

3. **데이터 수집 정상**
   ```
   2025-11-04 14:41:21-23 - 데이터 로드 완료: AAPL, MSFT, GOOGL, AMZN, NVDA, META, TSLA
   ```
   ✅ 7개 종목 모두 정상 수집 (42일 데이터)

4. **포트폴리오 동기화 정상**
   ```
   2025-11-04 14:41:24 - 포트폴리오 동기화 완료
   2025-11-04 14:41:24 - 포트폴리오 가치: $100000.00
   ```
   ✅ Alpaca 계정과 동기화 성공

5. **장시간 체크 정상**
   ```
   2025-11-04 01:12:18 - 장 마감 시간 (현재 ET: 20:12:18 EST, 장시간: 09:30-16:00)
   ```
   ✅ 장 마감 시간 정확히 감지

---

## ⚠️ **문제점**

### 🔴 **1. 초기 오류 (00:22 ~ 00:27)**
```
2025-11-04 00:22:25 - ERROR - 거래 루프 오류: 'PaperTrader' object has no attribute 'logger'
2025-11-04 00:23:50 - ERROR - 거래 루프 오류: 'PaperTrader' object has no attribute 'logger'
```
**원인**: 이전 버전의 `paper_trader.py` (local_simulator.py) 사용 중이었음
**상태**: ✅ 이미 수정됨 (01:38 이후부터 새 버전 사용)

### 🟡 **2. 거래 신호만 생성, 실제 거래 없음**

**신호 생성 현황**:
```
[AAPL] 신호 생성 완료: HOLD, 신뢰도: 0.30
[MSFT] 신호 생성 완료: HOLD, 신뢰도: 0.20
[GOOGL] 신호 생성 완료: HOLD, 신뢰도: 0.30
[AMZN] 신호 생성 완료: HOLD, 신뢰도: 0.30
[NVDA] 신호 생성 완료: HOLD, 신뢰도: 0.30
[META] 신호 생성 완료: HOLD, 신뢰도: 0.25
[TSLA] 신호 생성 완료: HOLD, 신뢰도: 0.30
```

**문제점**:
- ❌ **모든 신호가 HOLD** (매수/매도 신호 없음)
- ❌ **신뢰도가 매우 낮음** (0.00 ~ 0.45, 최소 임계값 0.60 미만)
- ❌ **실제 거래 0건** (매수/매도 주문 로그 없음)

**예상 원인**:
1. 신뢰도 임계값(0.60)이 너무 높음
2. 시장 상황이 매수/매도 신호를 생성하지 않음
3. 신호 생성 로직에서 HOLD만 반환

### 🟡 **3. 포지션 없음**

```
포트폴리오 가치: $100,000.00
현금: $100,000.00
보유 포지션: 0개
```

**분석**:
- 초기 자본과 동일 (수익/손실 없음)
- 거래가 한 건도 없었음

---

## 📈 **시스템 동작 상태**

### **타임라인 분석**

```
00:22:22 - 프로그램 시작 (오래된 버전)
00:22:25 - logger 오류 발생 (5분마다 반복)
00:27:41 - 재시작 (오래된 버전)
00:32:44 ~ 01:07:44 - 모니터링만 실행 (거래 없음)

01:12:15 - 재시작 (오래된 버전)
01:12:18 - 장 마감 시간 로그 출력 ✅

01:38:48 - 재시작 (새 버전 - Paper Trading API)
01:38:49 - Paper Trading 계정 연결 성공 ✅
02:55:06 - 재시작 (새 버전)
14:41:19 - 재시작 (새 버전, 장 개장 전)
14:49:52 - 재시작 (새 버전, 장 개장 후)

14:41:24 ~ 20:55:24 - 장 개장 중
  - 신호 생성: 매 분마다 (정상)
  - 포트폴리오 모니터링: 5분마다 (정상)
  - 하지만 거래 0건 ❌
```

---

## 📊 **신호 생성 통계**

### **신뢰도 분포** (14:41 ~ 20:57 UTC)

| 신뢰도 범위 | 빈도 | 비율 |
|-----------|------|------|
| 0.00 | 매우 많음 | ~30% |
| 0.10 ~ 0.20 | 많음 | ~40% |
| 0.25 ~ 0.30 | 많음 | ~25% |
| 0.35 ~ 0.45 | 적음 | ~5% |
| **0.60 이상** | **0** | **0%** ❌ |

**결론**: 신뢰도가 모두 임계값(0.60) 미만이어서 거래가 실행되지 않음

### **신호 타입**
- **BUY**: 0건
- **SELL**: 0건
- **HOLD**: 100% (모든 신호)

---

## 🎯 **주요 이벤트**

### **서비스 재시작**
- 총 **5회** 재시작
  - 00:22:22 (오래된 버전)
  - 00:27:41 (오래된 버전)
  - 01:12:15 (오래된 버전)
  - 01:38:48 (새 버전 - Paper Trading)
  - 02:55:06 (새 버전)
  - 14:41:19 (새 버전)
  - 14:49:52 (새 버전)

**가능한 원인**:
- 코드 업데이트
- 서비스 재시작 (systemctl restart)
- 크래시 후 자동 재시작

### **장 시간**
- **장 마감**: 01:12:18 UTC (20:12:18 EST) ✅ 정확히 감지
- **장 개장**: 14:30 UTC (09:30 EST) 추정
- **실제 거래 시간**: 14:41 ~ 20:55 UTC (약 6.5시간)

---

## ⚙️ **성능 지표**

### **API 호출**
- 계정 상태 확인: 정상
- 포트폴리오 동기화: 5분마다 정상
- 장시간 확인: 정상

### **데이터 처리**
- 데이터 수집: 평균 2초/종목
- 기술적 지표 계산: 정상 (72개 컬럼)
- 신호 생성: 1분마다 정상

### **리소스 사용**
- 로그 파일 크기: 대용량 (5500+ 줄)
- 메모리: 정상
- CPU: 정상

---

## 🔧 **권장 조치사항**

### **즉시 조치**

1. **신뢰도 임계값 조정 검토**
   ```python
   # 현재: min_confidence = 0.6
   # 제안: 0.4 ~ 0.5로 낮춤 (Paper Trading이므로)
   ```

2. **신호 생성 로직 검토**
   - 왜 모든 신호가 HOLD인지 확인
   - ML 모델 예측 결과 확인
   - 규칙 기반 신호 점수 확인

3. **로그 개선**
   - 신호 생성 실패 이유 로깅
   - 신뢰도가 낮은 이유 로깅
   - ML 모델 예측 확률 로깅

### **모니터링**

1. **11/5 로그 확인**
   - 장 개장 시간 거래 여부
   - 신호 생성 패턴 변화
   - 첫 거래 발생 여부

2. **신호 품질 모니터링**
   - BUY/SELL 신호 발생 빈도
   - 신뢰도 분포 변화
   - 실제 거래 발생 여부

---

## 📝 **요약**

### **✅ 정상 작동**
- Paper Trading API 연결
- 데이터 수집 및 처리
- 포트폴리오 동기화
- 장시간 체크
- 신호 생성 (기술적으로)

### **❌ 문제점**
- 실제 거래 0건
- 모든 신호가 HOLD
- 신뢰도가 모두 임계값 미만
- 초기 오류 (이미 해결됨)

### **🎯 결론**
시스템은 **기술적으로 정상 작동**하지만, **신호 품질 문제**로 인해 실제 거래가 발생하지 않았습니다. 신뢰도 임계값 조정 또는 신호 생성 로직 개선이 필요합니다.

---

**생성일**: 2025-11-04
**분석자**: AI Assistant


